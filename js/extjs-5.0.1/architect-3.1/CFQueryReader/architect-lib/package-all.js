Ext.define("Ext.ux.CFQueryReader.data.reader.CFQuery",{extend:Ext.data.reader.Array,alias:"reader.cfquery",config:{queryProperty:"QUERY",totalProperty:"TOTALROWCOUNT",idProperty:null},readRecords:function(d){var k;var e,h,l,g,f,a;var m;var c;var j;var n;k=this;n=true;if(d.DATA&&d.COLUMNS){d={QUERY:d}}if(d.metaData){k.onMetaChange(d.metaData);if(d.metaData.fields){n=false}}if(n){c=k.getQuery(d);try{if(Ext.isObject(c)===false){throw"The 'query' is not properly mapped to the response."}else{if((c.DATA&&Ext.isArray(c.DATA))===false||(c.COLUMNS&&Ext.isArray(c.COLUMNS))===false){throw"A 'query' is not defined in the server output."}}f=k.getModel();g=Ext.Array.clone(f.prototype.fields);h=c.COLUMNS.length;for(e=0;e<h;e++){c.COLUMNS[e]=c.COLUMNS[e].toUpperCase()}h=g.length;for(e=0;e<h;e++){a=g[e].getName().toUpperCase();l=Ext.Array.indexOf(c.COLUMNS,a);if(l>=0){g[e].mapping=l}}m=k.getIdProperty();if(m){f.idProperty=m}f.replaceFields(g,true);k.setModel(f,true)}catch(b){j=new Ext.data.ResultSet({total:0,count:0,records:[],success:false,message:b});k.fireEvent("exception",k,d,j);Ext.Logger.warn(b);return j}}k.rawData=d;return k.callParent([d])},buildExtractors:function(){var d=this;var c;var e;var b;var a;c=d.getConfig();b=c.queryProperty;a=c.rootProperty;if(b&&!a){c.rootProperty=a=b}if(!a){Ext.Error.raise({message:"Unable to determine the <rootProperty> value for this reader. Has <queryProperty> been unset?"})}e=a.replace(/(^|\.)DATA$/,"");b=e;a=(e.length)?e+".DATA":"DATA";c.queryProperty=b;c.rootProperty=a;d.getQuery=d.createAccessor(b);d.getRoot=d.createAccessor(a);d.callParent(arguments)}});